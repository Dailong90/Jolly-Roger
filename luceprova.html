<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Enigma – Lanterna</title>
<style>
  :root { --x: 50vw; --y: 50vh; --r: 120px; }
  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  html, body { height:100%; margin:0; }
  body {
    font-family: Georgia, "Times New Roman", serif;
    background:#0b0b0b;
    color:#ddd;
    overflow:hidden;
  }
  .scene {
    position:relative; width:100%; height:100%;
    background:
      radial-gradient(1200px 800px at 70% 30%, #0e0e0e, #0b0b0b 60%, #000 100%),
      url('assets/jolly_bay.jpg') center/cover no-repeat; /* opzionale */
    filter: saturate(0.7) brightness(0.9);
  }
  .overlay {
    position:absolute; inset:0;
    pointer-events:none; /* la luce non blocca il puntatore */
    background:
      radial-gradient(circle at var(--x) var(--y),
        rgba(0,0,0,0) 0,
        rgba(0,0,0,0) calc(var(--r) - 10px),
        rgba(0,0,0,0.4) var(--r),
        rgba(0,0,0,0.78) calc(var(--r) + 100px),
        rgba(0,0,0,0.92) 100%);
    transition: background-position .05s linear;
    mix-blend-mode: multiply;
  }
  .secret {
    position:absolute; inset:0;
    display:grid; place-items:center;
    text-align:center; padding:24px;
  }
  /* Trucco di “quasi invisibilità”: testo scuro su sfondo scuro,
     si legge bene solo nel cono di luce */
  .secret p {
    max-width: min(680px, 90vw);
    line-height:1.4;
    letter-spacing: .5px;
    margin:0;
  }
  .secret .riga {
    font-variant-ligatures: none;
    /* quasi invisibile senza luce */
    color:#141414;
    text-shadow:
      0 0 0 #141414,
      0 0 1px #111; /* leggero rumore */
    font-size: clamp(18px, 2.6vw, 28px);
  }
  .secret .forte { font-size: clamp(28px, 4vw, 40px); }
  /* Indizi decoy (facoltativi) appena più chiari per confondere */
  .decoy {
    position:absolute; inset:0; pointer-events:none;
    background:
      repeating-linear-gradient(90deg, rgba(255,255,255,0.01) 0 2px, rgba(0,0,0,0) 2px 4px),
      radial-gradient(800px 500px at 20% 80%, rgba(255,255,255,0.02), rgba(0,0,0,0));
    mix-blend-mode: screen; opacity:.25;
  }
  /* Istruzioni/minimap */
  .ui {
    position: absolute; bottom:14px; left:14px; right:14px;
    display:flex; justify-content:space-between; align-items:center;
    font-size:14px; color:#bdbdbd; gap:10px; opacity:.85;
  }
  .badge {
    border:1px solid #2e2e2e; padding:6px 10px; border-radius:999px;
    background:#111; backdrop-filter: blur(2px);
  }
  .cursor {
    position:absolute; width:12px; height:12px; border-radius:50%;
    border:2px solid #fff; box-shadow:0 0 12px rgba(255,255,255,.75);
    left: calc(var(--x) - 6px); top: calc(var(--y) - 6px);
    pointer-events:none; transition:left .05s linear, top .05s linear;
  }
</style>
</head>
<body>
  <div class="scene" id="scene">
    <div class="secret" aria-hidden="true">
      <p class="riga">Dove la scogliera bacia il molo…</p>
      <p class="riga">…cerca il segno inciso tra catene e ruggine.</p>
      <p class="riga forte">N 40° 56.<span style="letter-spacing:2px;">●●●</span>  E 014° 59.<span style="letter-spacing:2px;">●●●</span></p>
      <p class="riga">La verità appare solo alla luce giusta.</p>
    </div>
    <div class="decoy"></div>
    <div class="overlay" id="overlay"></div>
    <div class="cursor" id="cursor" aria-hidden="true"></div>
    <div class="ui">
      <span class="badge">Sposta la luce per leggere</span>
      <span class="badge">Doppio tap/clic: cambia raggio</span>
    </div>
  </div>

<script>
  (function(){
    const root = document.documentElement;
    const scene = document.getElementById('scene');
    const cursor = document.getElementById('cursor');
    let radius = 120;

    const setPos = (x, y) => {
      root.style.setProperty('--x', x + 'px');
      root.style.setProperty('--y', y + 'px');
      cursor.style.left = (x - 6) + 'px';
      cursor.style.top  = (y - 6) + 'px';
    };
    const setRadius = (r) => {
      radius = Math.max(60, Math.min(240, r));
      root.style.setProperty('--r', radius + 'px');
    };

    const handle = (clientX, clientY) => {
      const rect = scene.getBoundingClientRect();
      const x = clientX - rect.left;
      const y = clientY - rect.top;
      setPos(x, y);
    };

    scene.addEventListener('pointermove', e => handle(e.clientX, e.clientY), {passive:true});
    scene.addEventListener('pointerdown', e => handle(e.clientX, e.clientY), {passive:true});
    scene.addEventListener('pointerenter', e => handle(e.clientX, e.clientY), {passive:true});

    // Doppio click/tap per cambiare la dimensione del fascio
    let last = 0;
    scene.addEventListener('pointerdown', e => {
      const now = Date.now();
      if (now - last < 300) setRadius(radius >= 200 ? 110 : radius + 50);
      last = now;
    });

    // posizione iniziale al centro
    const rect = scene.getBoundingClientRect();
    setPos(rect.width/2, rect.height/2);
    setRadius(radius);
    window.addEventListener('resize', () => {
      const r = scene.getBoundingClientRect();
      setPos(r.width/2, r.height/2);
    });
  })();
</script>
</body>
</html>
